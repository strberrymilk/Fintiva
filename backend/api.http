@baseUrl = http://127.0.0.1:8000

########################################################
# 1) (Opcional) Login de Oscar para obtener token JWT
#    Si tu /auth/login aún falla, puedes omitir el token:
#    borra la cabecera Authorization en las peticiones.
########################################################
# @name loginOscar
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "identificador": "2288551538",
  "contrasena": "hash_agricultura"
}

@token = {{loginOscar.response.body.$.access_token}}

########################################################
# 2) Buscar a “Oscar Aguilar” y guardar su id_usuario
########################################################
# @name getOscar
GET {{baseUrl}}/usuarios?q=Oscar Aguilar

@userId = {{getOscar.response.body.$[0].id_usuario}}

########################################################
# 3) Verificar que el id_usuario sí existe
########################################################
GET {{baseUrl}}/usuarios/{{userId}}

########################################################
# 4A) Registrar GASTOS para Oscar (forma recomendada: id en la ruta)
########################################################
# @name crearGastosRuta
POST {{baseUrl}}/usuarios/{{userId}}/gastos
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "gasto_agua": 500,
  "gasto_gas": 300,
  "gasto_luz": 250,
  "gasto_semillas": 800,
  "gasto_fertilizantes": 600,
  "gasto_mantenimiento": 400,
  "gasto_combustible": 200
}

########################################################
# 4B) Alternativa: Registrar GASTOS (id en el body)
########################################################
POST {{baseUrl}}/gastos
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "id_usuario": {{userId}},
  "gasto_agua": 200,
  "gasto_gas": 100,
  "gasto_luz": 100,
  "gasto_semillas": 400,
  "gasto_fertilizantes": 300,
  "gasto_mantenimiento": 200,
  "gasto_combustible": 100
}

########################################################
# 5) Consultar los gastos de Oscar
########################################################
GET {{baseUrl}}/usuarios/{{userId}}/gastos

########################################################
# 6) (Opcional) Métrica: Gastos trimestrales de Oscar
########################################################
GET {{baseUrl}}/metrics/gastos-trimestrales/{{userId}}

########################################################
# 7) (Opcional) Métrica: Parcelas y # de cultivos (para dashboard)
########################################################
GET {{baseUrl}}/metrics/parcelas-cultivos/{{userId}}
